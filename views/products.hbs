{{#if products}}
    <div class="container">
        <p>Volver al <a href="/catalog">Catalogo</a></p>
    </div>
    <div id="container">
        <div class="buttons">
            <ul class="grid">
                {{#each products }}
                <li class="grid-group-item d-flex bd-highlight">
                    {{#if this.available}}
                    <div>
                        <img id="image{{id}}" src="{{ this.image }}" onerror="imageHasError({{this.id}}, '{{this.alt}}');"
                            height="200px" width="200px" 
                            style="background-size:cover;">
                    </div>
                    {{else}}
                    <div class="unavailableWrapper">
                        <img class="unavailableImage" id="image{{id}}" src="{{ this.image }}"
                            onerror="imageHasError({{this.id}}, '{{this.alt}}');" 
                            height="200px" width="200px"
                            style="background-size:cover;">
                    </div>
                    {{/if}}
                    <h3>{{ this.name }}</h3>
                    <i>{{this.description}}</i>
                    <p>{{ this.price }} Lps </p>
                    {{#if this.available}}
                    
                    <form class="form-inline" name="form_{{this.id}}" action="/add/{{this.id}}/{{this.categoryId}}" method="POST">
                        {{!-- Amount of products --}}
                        <a onclick="subs({{ this.id }})" class="btn btn-default" 
                            role="button" style="margin-bottom: 0;">-</a>
                        <input type="numeric" class="form-control" value="1" style="max-width: 30%;" name="count"
                            id="count_{{this.id}}" max="10" onchange="checkValue()">
                        <a onclick="sum({{ this.id }})" class="btn btn-info" 
                            role="button" style="margin-bottom: 0;">+</a>
                        
                        {{!-- Add products --}}
                        <a class="btn btn-default" role="button" onclick="add({{this.id}});"><i class="fa fa-shopping-cart"
                            aria-hidden="true"></i> Agregar</a>
                    </form>

                    {{else}}
                    <span class="badge badge-danger">Agotado</span>
                    {{/if}}
                </li>
                {{/each}}
            </ul>
        </div>
    </div>
{{else}}
<div class="container">
    {{#if keyword}}
    <i>No hay productos en este momento para la busqueda: "{{keyword}}"</i>
    {{else}}
    <i>No hay productos en este momento.</i>
    {{/if}}
</div>
{{/if}}

<div class="footer" style="padding:25px">
    <p>La Tiendita del Rio &copy; (2020)</p>
    <p>+504 9947-5935</p>
    <p>Barrio Rio Piedras 7 calle 20 avenida</p>
    <a href="https://www.instagram.com/riopiedras.store/">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/Instagram_icon.png/1024px-Instagram_icon.png" 
            alt=""
            width="25px">
            <br>
        Siguenos en Instagram
    </a>
    <br>
    <br>
    <a href="/contact">Acerca de Nosotros</a>
</div>
<script>
    function imageHasError(imageId, source) {
        document.getElementById(`image${imageId}`).src = source;
    }

    function add(id) {
        $(`form[name='form_${id}']`).submit();
    }

    function sum(id) {
        let currentVal = parseInt($(`#count_${id}`).val());
        if (currentVal >= 5) {
            $(`#count_${id}`).val(currentVal);
        }
        else {
            $(`#count_${id}`).val(currentVal + 1);
        }
    }

    function subs(id) {
        let currentVal = parseInt($(`#count_${id}`).val());
        if (currentVal == 1) {
            $(`#count_${id}`).val(currentVal);
        }
        else {
            $(`#count_${id}`).val(currentVal - 1);
        }
    }

    function checkValue(selfi) {
        if (selfi.value > 5) {
            selfi.value = 5;
        }
        else if (selfi.value < 1) {
            selfi.value = 1;
        }
    }
</script>